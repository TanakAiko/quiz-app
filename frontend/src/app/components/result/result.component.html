<div class="result-container">
  <div class="container-sm">
    <div class="result-content animate-fade-in">
      
      <!-- Success Animation -->
      <div class="result-header">
        <div class="result-animation">
          <span class="result-icon">ğŸ‰</span>
          <div class="confetti">
            <span class="confetti-piece">ğŸŠ</span>
            <span class="confetti-piece">âœ¨</span>
            <span class="confetti-piece">ğŸŒŸ</span>
            <span class="confetti-piece">ğŸ’«</span>
          </div>
        </div>
        
        <h1 class="result-title">
          Congratulations!
        </h1>
        
        <p class="result-subtitle">
          You've completed the Quote Challenge!
        </p>
      </div>

      <!-- Results Summary Card -->
      <div class="results-card card">
        <div class="card-header">
          <h2>Your Results</h2>
        </div>
        
        <div class="card-body">
          <div class="score-display">
            <div class="score-circle">
              <div class="score-inner">
                <span class="score-number">{{ correct }}</span>
                <span class="score-total">/ {{ total }}</span>
              </div>
            </div>
            
            <div class="score-details">
              <div class="score-percentage">{{ (correct / total * 100) | number:'1.0-0' }}%</div>
              <div class="score-label">Success Rate</div>
            </div>
          </div>
          
          <div class="performance-stats">
            <div class="stat-row">
              <span class="stat-label">Correct Answers:</span>
              <span class="stat-value correct">{{ correct }} âœ…</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Incorrect Answers:</span>
              <span class="stat-value incorrect">{{ incorrect }} âŒ</span>
            </div>
            @if (timeTaken !== null) {
            <div class="stat-row">
              <span class="stat-label">Time Taken:</span>
              <span class="stat-value">{{ (timeTaken / 60) | number:'1.0-0' }}m {{ (timeTaken % 60) | number:'2.0-0' }}s â±ï¸</span>
            </div>
            }
          </div>
        </div>
      </div>

      <!-- Achievement Badges -->
      <div class="achievements-section">
        <h3>Achievements Unlocked</h3>
        <div class="badges-grid">
          <div class="badge-item earned">
            <span class="badge-icon">ğŸ¯</span>
            <span class="badge-name">First Try</span>
            <span class="badge-desc">Completed your first quiz</span>
          </div>
          @if (correct >= 4) {
          <div class="badge-item earned">
            <span class="badge-icon">ğŸ“š</span>
            <span class="badge-name">Quote Scholar</span>
            <span class="badge-desc">Got 4+ quotes correct</span>
          </div>
          }
          @if (correct === total) {
          <div class="badge-item earned">
            <span class="badge-icon">ğŸ†</span>
            <span class="badge-name">Perfect Score</span>
            <span class="badge-desc">Get all answers correct</span>
          </div>
          }
          
          @if (timeTaken !== null && timeTaken < 120) {
          <div class="badge-item earned">
            <span class="badge-icon">âš¡</span>
            <span class="badge-name">Speed Demon</span>
            <span class="badge-desc">Complete in under 2 minutes</span>
          </div>
          }
         
        </div>
      </div>

      <!-- Submit Score to Leaderboard -->
      @if (!scoreSubmitted) {
      <div class="submit-score-section">
        <form (ngSubmit)="submitScore()" class="submit-score-form">
          <label for="playerName">Enter your name to appear on the leaderboard:</label>
          <input id="playerName" [(ngModel)]="playerName" name="playerName" required [disabled]="isSubmitting" />
          <button type="submit" [disabled]="isSubmitting || !playerName.trim()" class="btn btn-primary btn-lg">
            {{ isSubmitting ? 'Submitting...' : 'Submit Score' }}
          </button>
          @if (submitError) {
          <div class="error">{{ submitError }}</div>
          }
        </form>
      </div>
      }
      @if (scoreSubmitted) {
      <div class="submit-success">
        <div class="alert alert-success">Your score has been submitted to the leaderboard!</div>
      </div>
      }

      <!-- Detailed Results -->
      <div class="detailed-results">
        <h3>Question Breakdown</h3>
        <div class="questions-list">
          @for (key of (quotes | keyvalue); track key) {
            <div class="question-item" [ngClass]="{'correct': results[+key.key] === true, 'incorrect': results[+key.key] === false}">
              <div class="question-header">
                <span class="question-number">{{ +key.key + 1 }}</span>
                <span class="question-status">
                  {{ results[+key.key] === true ? 'âœ…' : results[+key.key] === false ? 'âŒ' : 'â³' }}
                </span>
              </div>
              <div class="question-content">
                <p class="question-quote">"{{ quotes[+key.key]?.quote }}"</p>
                <div class="question-answer">
                  <span class="answer-label">Your answer:</span>
                  <span class="answer-text" [ngClass]="{'correct': results[+key.key] === true, 'incorrect': results[+key.key] === false}">
                    {{ answers[+key.key] || 'â€”' }}
                  </span>
                </div>
              </div>
            </div>
          }
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="result-actions">
        <button class="btn btn-primary btn-lg">
          <span class="btn-icon">ğŸ”„</span>
          Try Again
        </button>
        
        <button class="btn btn-success btn-lg">
          <span class="btn-icon">ğŸ“¤</span>
          Share Results
        </button>
        
        <a routerLink="/leaderboard" class="btn btn-secondary btn-lg">
          <span class="btn-icon">ğŸ†</span>
          View Leaderboard
        </a>
        
        <a routerLink="/" class="btn btn-secondary">
          <span class="btn-icon">ğŸ </span>
          Back to Home
        </a>
      </div>

    </div>
  </div>
</div>